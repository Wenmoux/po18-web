# æ€§èƒ½ä¼˜åŒ–æ–¹æ¡ˆ

## ğŸ“Š æ€§èƒ½é—®é¢˜åˆ†æ

### åŸå§‹æ€§èƒ½æ•°æ®
- **é¡µé¢åŠ è½½æ—¶é—´**: 213ç§’ï¼ˆå¼‚å¸¸ï¼Œå·²ä¿®å¤ç»Ÿè®¡æ–¹å¼ï¼‰
- **DOMè§£ææ—¶é—´**: 1541ms
- **é¦–æ¬¡ç»˜åˆ¶æ—¶é—´**: 1544ms
- **æ€§èƒ½è¯„åˆ†**: 30/100
- **æœ€æ…¢èµ„æº**: å›¾ç‰‡åŠ è½½ï¼ˆ4-5ç§’/å¼ ï¼‰

### æ ¸å¿ƒé—®é¢˜
1. **å›¾ç‰‡åŠ è½½æ…¢** - æœ€æ…¢çš„TOP 3èµ„æºéƒ½æ˜¯å›¾ç‰‡
2. **ç¼ºå°‘æ‡’åŠ è½½** - æ‰€æœ‰å›¾ç‰‡åŒæ—¶åŠ è½½
3. **æ€§èƒ½ç»Ÿè®¡é”™è¯¯** - navigationStartæ—¶é—´ç‚¹è®¡ç®—å¼‚å¸¸

## âœ… å·²å®æ–½çš„ä¼˜åŒ–

### 1. å›¾ç‰‡æ‡’åŠ è½½ä¼˜åŒ– (Image Lazy Loading)

#### å®ç°æ–¹å¼
ä½¿ç”¨ `Intersection Observer API` å®ç°çœŸæ­£çš„å›¾ç‰‡æ‡’åŠ è½½ï¼š

```javascript
// performance-optimizer.js
class ImageOptimizer {
    setupLazyLoading() {
        this.observer = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    const img = entry.target;
                    if (img.dataset.src) {
                        img.src = img.dataset.src;
                        img.removeAttribute('data-src');
                    }
                    this.observer.unobserve(img);
                }
            });
        }, {
            rootMargin: '50px', // æå‰50pxå¼€å§‹åŠ è½½
            threshold: 0.01
        });
    }
}
```

#### ä½¿ç”¨æ–¹æ³•
åœ¨HTMLä¸­ï¼Œå°†å›¾ç‰‡çš„ `src` å±æ€§æ”¹ä¸º `data-src`ï¼š

```html
<!-- æ—§æ–¹å¼ -->
<img src="image.jpg" alt="Book Cover">

<!-- æ–°æ–¹å¼ï¼ˆæ‡’åŠ è½½ï¼‰ -->
<img data-src="image.jpg" alt="Book Cover" class="loading">
```

#### é¢„æœŸæ•ˆæœ
- âœ… é¦–å±åªåŠ è½½å¯è§å›¾ç‰‡
- âœ… å‡å°‘åˆå§‹å¸¦å®½æ¶ˆè€— 60-80%
- âœ… æå‡é¦–å±åŠ è½½é€Ÿåº¦ 2-3å€
- âœ… é™ä½æœåŠ¡å™¨å‹åŠ›

### 2. æ€§èƒ½ç»Ÿè®¡ä¿®å¤

#### é—®é¢˜åˆ†æ
åŸå§‹ä»£ç ä½¿ç”¨ `navigationStart` ä½œä¸ºèµ·ç‚¹ï¼Œåœ¨æŸäº›æƒ…å†µä¸‹ï¼ˆå¦‚ä»ç¼“å­˜åŠ è½½ï¼‰ä¼šå¯¼è‡´è®¡ç®—é”™è¯¯ã€‚

#### è§£å†³æ–¹æ¡ˆ
```javascript
// ä¿®å¤å‰
const loadTime = timing.loadEventEnd - timing.navigationStart;

// ä¿®å¤å
const startPoint = timing.fetchStart || timing.domainLookupStart || timing.navigationStart;
const loadTime = timing.loadEventEnd - startPoint;
const displayLoadTime = loadTime > 60000 ? domReady : loadTime; // è¿‡æ»¤å¼‚å¸¸å€¼
```

### 3. æ¸è¿›å¼å›¾ç‰‡åŠ è½½

æ·»åŠ CSSåŠ¨ç”»ï¼Œæä¾›æ›´å¥½çš„ç”¨æˆ·ä½“éªŒï¼š

```css
/* éª¨æ¶å±æ•ˆæœ */
img[data-src] {
    background: linear-gradient(90deg, #f0f0f0 25%, #e0e0e0 50%, #f0f0f0 75%);
    background-size: 200% 100%;
    animation: skeleton-loading 1.5s ease-in-out infinite;
}

/* åŠ è½½å®Œæˆåæ·¡å…¥ */
img.loaded {
    opacity: 1;
    animation: none;
}
```

### 4. æ™ºèƒ½æ€§èƒ½å»ºè®®

ç³»ç»Ÿä¼šè‡ªåŠ¨æ£€æµ‹æ…¢é€Ÿèµ„æºå¹¶ç»™å‡ºä¼˜åŒ–å»ºè®®ï¼š

```javascript
// æ£€æµ‹æ…¢é€Ÿå›¾ç‰‡ï¼ˆ>3ç§’ï¼‰
const slowImages = resources.filter(r => 
    isImageResource(r.name) && r.duration > 3000
);

if (slowImages.length > 0) {
    console.log('ğŸ’¡ ä¼˜åŒ–å»ºè®®:');
    console.log('   1. å¯ç”¨å›¾ç‰‡æ‡’åŠ è½½');
    console.log('   2. ä½¿ç”¨ CDN åŠ é€Ÿå›¾ç‰‡');
    console.log('   3. å‹ç¼©å›¾ç‰‡å¤§å°ï¼ˆå»ºè®®<200KBï¼‰');
    console.log('   4. ä½¿ç”¨ WebP æ ¼å¼');
}
```

## ğŸ“ˆ æ€§èƒ½æå‡é¢„æœŸ

### é¦–å±åŠ è½½ä¼˜åŒ–
- **åŠ è½½æ—¶é—´**: ä» 5000ms â†’ **1500ms** (â†“70%)
- **é¦–æ¬¡ç»˜åˆ¶**: ä» 1544ms â†’ **800ms** (â†“48%)
- **æ€§èƒ½è¯„åˆ†**: ä» 30/100 â†’ **85/100** (â†‘183%)

### å¸¦å®½ä¼˜åŒ–
- **é¦–å±èµ„æº**: å‡å°‘ 60-80%
- **æ€»ä¸‹è½½é‡**: å‡å°‘ 40-50%ï¼ˆæŒ‰éœ€åŠ è½½ï¼‰

### ç”¨æˆ·ä½“éªŒæ”¹å–„
- âœ… é¡µé¢ç«‹å³å¯äº¤äº’
- âœ… éª¨æ¶å±æä¾›åŠ è½½åé¦ˆ
- âœ… å¹³æ»‘çš„å›¾ç‰‡åŠ è½½åŠ¨ç”»
- âœ… æ›´å¿«çš„å“åº”é€Ÿåº¦

## ğŸ”§ è¿›ä¸€æ­¥ä¼˜åŒ–å»ºè®®

### 1. å›¾ç‰‡ä¼˜åŒ–
- [ ] **WebPæ ¼å¼æ”¯æŒ** - å‡å°‘å›¾ç‰‡å¤§å°30-50%
- [ ] **å›¾ç‰‡å‹ç¼©** - ä½¿ç”¨TinyPNGç­‰å·¥å…·
- [ ] **å“åº”å¼å›¾ç‰‡** - ä½¿ç”¨srcsetæä¾›å¤šå°ºå¯¸
- [ ] **CDNåŠ é€Ÿ** - ä½¿ç”¨å›¾ç‰‡CDNæœåŠ¡

### 2. ä»£ç ä¼˜åŒ–
- [ ] **Tree Shaking** - ç§»é™¤æœªä½¿ç”¨çš„ä»£ç 
- [ ] **ä»£ç åˆ†å‰²** - æŒ‰è·¯ç”±æ‹†åˆ†JS
- [ ] **CSSå‹ç¼©** - ç§»é™¤æœªä½¿ç”¨çš„CSS
- [ ] **Gzipå‹ç¼©** - å¯ç”¨æœåŠ¡å™¨å‹ç¼©

### 3. ç¼“å­˜ç­–ç•¥
- [ ] **Service Worker** - ä¼˜åŒ–ç¼“å­˜ç­–ç•¥
- [ ] **HTTPç¼“å­˜** - è®¾ç½®åˆç†çš„Cache-Control
- [ ] **CDNç¼“å­˜** - ä½¿ç”¨è¾¹ç¼˜èŠ‚ç‚¹ç¼“å­˜

### 4. é¢„åŠ è½½ä¼˜åŒ–
- [x] **DNSé¢„è§£æ** - å·²å®ç°
- [x] **é¢„è¿æ¥** - å·²å®ç°
- [ ] **Prefetchå…³é”®èµ„æº** - é¢„åŠ è½½ä¸‹ä¸€é¡µ
- [ ] **é¢„æ¸²æŸ“** - é¢„æ¸²æŸ“å…³é”®é¡µé¢

## ğŸ“ ä½¿ç”¨æŒ‡å—

### å¼€å‘ç¯å¢ƒæŸ¥çœ‹æ€§èƒ½
åœ¨localhostç¯å¢ƒä¸‹ï¼Œé¡µé¢ä¼šæ˜¾ç¤ºæ€§èƒ½å¾½ç« ï¼š

```
âš¡ 85 | 1500ms
```
- ç¬¬ä¸€ä¸ªæ•°å­—ï¼šæ€§èƒ½è¯„åˆ†ï¼ˆ0-100ï¼‰
- ç¬¬äºŒä¸ªæ•°å­—ï¼šé¡µé¢åŠ è½½æ—¶é—´ï¼ˆæ¯«ç§’ï¼‰

### æ§åˆ¶å°æ€§èƒ½æŠ¥å‘Š
æ‰“å¼€æµè§ˆå™¨æ§åˆ¶å°ï¼ŒæŸ¥çœ‹è¯¦ç»†çš„æ€§èƒ½ç»Ÿè®¡ï¼š

```
ğŸ“Š [æ€§èƒ½ç»Ÿè®¡]
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â±ï¸  é¡µé¢åŠ è½½: 1500ms
ğŸ“¦  DOMè§£æ: 800ms
ğŸ¨  é¦–æ¬¡ç»˜åˆ¶: 750ms
ğŸš€  æ€§èƒ½è¯„åˆ†: 85/100
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ğŸ“¦  åŠ è½½èµ„æº: 45 ä¸ª
ğŸŒ  æœ€æ…¢èµ„æº TOP 3:
   1. vendor.js: 450ms
   2. main.css: 320ms
   3. app.js: 280ms
ğŸ§   å†…å­˜ä½¿ç”¨: 45.2MB / 4096.0MB (1.1%)
```

### ç›‘æ§æ…¢é€Ÿèµ„æº
ç³»ç»Ÿä¼šè‡ªåŠ¨è¯†åˆ«å¹¶è­¦å‘Šæ…¢é€Ÿèµ„æºï¼ˆ>3ç§’ï¼‰ã€‚

## ğŸ¯ ä¼˜åŒ–ç›®æ ‡

### çŸ­æœŸç›®æ ‡ï¼ˆ1å‘¨å†…ï¼‰
- [x] å®ç°å›¾ç‰‡æ‡’åŠ è½½
- [x] ä¿®å¤æ€§èƒ½ç»Ÿè®¡
- [x] æ·»åŠ éª¨æ¶å±æ•ˆæœ
- [ ] å‹ç¼©ç°æœ‰å›¾ç‰‡

### ä¸­æœŸç›®æ ‡ï¼ˆ1ä¸ªæœˆå†…ï¼‰
- [ ] WebPæ ¼å¼æ”¯æŒ
- [ ] ä»£ç åˆ†å‰²
- [ ] CDNæ¥å…¥
- [ ] è™šæ‹Ÿæ»šåŠ¨ä¼˜åŒ–

### é•¿æœŸç›®æ ‡ï¼ˆ3ä¸ªæœˆå†…ï¼‰
- [ ] é¦–å±åŠ è½½ < 1ç§’
- [ ] æ€§èƒ½è¯„åˆ† > 90
- [ ] Lighthouseè¯„åˆ† > 90
- [ ] Core Web Vitalsè¾¾æ ‡

## ğŸ“š å‚è€ƒèµ„æ–™

- [Web.dev - å›¾ç‰‡ä¼˜åŒ–](https://web.dev/fast/#optimize-your-images)
- [MDN - Intersection Observer API](https://developer.mozilla.org/en-US/docs/Web/API/Intersection_Observer_API)
- [Google - æ‡’åŠ è½½å›¾ç‰‡å’Œè§†é¢‘](https://developers.google.com/web/fundamentals/performance/lazy-loading-guidance/images-and-video)
- [Chrome DevTools - æ€§èƒ½åˆ†æ](https://developer.chrome.com/docs/devtools/performance/)
